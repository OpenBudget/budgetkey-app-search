<div [ngClass]="{
  row : true,
  headerBottomBorder : headerBottomBorder}" >

  <div id="search-box-and-download">
    <div id="whole-searchbox" class="search-box input-group input-group-lg">
      <div id="search-box-types-side" [ngClass]="['input-group-addon','outer-right-side', 'roundCorners-border-right-side']" (click)="openCloseSearchTypeDropDown();">  
        <div [ngClass]="['inner-right-side', 'roundCorners-border-right-side',  isSearchBarHasText ? (isAllTabSelected ? 'has-text-all-tab' : 'has-text-not-all-tab') : isSearchBarHasFocus? 'inner-without-text-with-focus' : 'inner-without-text-without-focus']">     <!--        isSearchBarHasFocus? 'inner-without-text-with-focus' : 'inner-without-text-without-focus' -->
          <div id="right-side-symbols" class="right-side-symbols">
            <img [src]="(!isAllTabSelected && isSearchBarHasText? 'assets/img/search-glass-white.svg' : 'assets/img/search-glass-red.png')" *ngIf="!isSearching" [ngClass]="['search-icon','search-icon-margin']">  <!--</i> , term ? 'search-icon' : '' -->   <!--'glyphicon', 'glyphicon-search', -->
            <i *ngIf="isSearching" class="fa fa-circle-o-notch fa-spin search-icon-margin"></i>
            <span id="type-text-in-search-bar" *ngIf="isClickedType && isSearchBarHasText || !isAllTabSelected" class="type-text-in-search-bar-right">
              {{selectedTabName}} ({{currentNumOfResults.toLocaleString()}})
            </span>
            <span id="drop-down-caret" class="drop-down-caret">  
              <i [ngClass]="[isSearchBarHasText ? (isAllTabSelected ? 'down-arrow-red' : 'down-arrow-white') : (isSearchBarHasFocus ? 'down-arrow-red' : 'down-arrow-red')]" > </i> <!-- [ngClass]="[ isAllTabSelected ?  'down-arrow-red' : (isSearchBarHasFocus ? 'down-arrow-red' : 'down-arrow-white') ]" -->
            </span> 
          </div>

          <div id="search-types-dropdown-content" class="dropdown-content">
            <a href="#" (click)="openCloseSearchTypeDropDown();  switchTab($event, 'all', true, 'הכל', resultTotal ? resultTotal.toLocaleString()  : '0' );"> הכל
              <span>
                  ({{resultTotal ? resultTotal.toLocaleString()  : '0'}})
              </span>
            </a> 
            <a href="#" (click)="openCloseSearchTypeDropDown(); switchTab($event, 'budget', false, 'סעיף תקציבי', resultTotalCount.budget ? resultTotalCount.budget.toLocaleString()  : '0' );">סעיף תקציבי
              <span>
                  ({{resultTotalCount.budget ? resultTotalCount.budget.toLocaleString()  : '0'}})
              </span>
            </a>
            <a href="#" (click)="openCloseSearchTypeDropDown(); switchTab($event, 'entities', false, 'ארגון',resultTotalCount.entities ? resultTotalCount.entities.toLocaleString()  : '0'); ">ארגון
              <span>
                  ({{resultTotalCount.entities ? resultTotalCount.entities.toLocaleString()  : '0'}})
              </span>
            </a>
            <a href="#" (click)="openCloseSearchTypeDropDown(); switchTab($event, 'national-budget-changes', false, 'העברה תקציבית', resultTotalCount.nationalbudgetchanges ? resultTotalCount.nationalbudgetchanges.toLocaleString()  : '0' );">העברה תקציבית
              <span>
                  ({{resultTotalCount.nationalbudgetchanges ? resultTotalCount.nationalbudgetchanges.toLocaleString()  : '0'}})
              </span>
            </a>
            <a href="#" (click)= "openCloseSearchTypeDropDown(); switchTab($event, 'supports', false, 'תמיכות', resultTotalCount.supports ? resultTotalCount.supports.toLocaleString()  : '0' );">תמיכות
              <span>
                  ({{resultTotalCount.supports ? resultTotalCount.supports.toLocaleString()  : '0'}})
              </span>
            </a>
            <a href="#" (click)="openCloseSearchTypeDropDown(); switchTab($event, 'tenders,contract-spending', false , 'רכש',(resultTotalCount.tenders + resultTotalCount.contractspending) ? (resultTotalCount.tenders + resultTotalCount.contractspending).toLocaleString()  : '0' ); ">רכש
              <span>
                  ({{(resultTotalCount.tenders + resultTotalCount.contractspending) ? (resultTotalCount.tenders + resultTotalCount.contractspending).toLocaleString()  : '0'}})
              </span>
            </a> 
          </div>
        </div>
      </div>
      
      <input #searchBox 
              [ngClass]="['form-control', 'roundCorners-border-left-side', 'left-side-search']"
              type="text"
              placeholder="חפשו הכל... סעיף תקציבי, ארגון, אדם, או כל דבר אחר העולה על דעתכם..."
              autofocus
              (keyup)="search(searchBox.value)"
              ((keydown.backspace)="search(searchBox.value)"
              [value]="term"
              (focus)="onSeachBarFocus()"
              (focusout)="onSeachBarFocusOut()"
              />
      
      

    </div>

  <a href='javascript:void(0)' (click)="download(term);"> Download </a>
  </div>
  
</div>

<div #searchBody class="search_body">

  <div *ngFor="let item of allDocs | async; let i = index" >
    <search-result [item]="item" [index]="i"></search-result>
  </div>
  <h1 class="status">{{getStatusText()}}</h1>
</div>



